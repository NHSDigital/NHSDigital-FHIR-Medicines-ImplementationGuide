<CapabilityStatement xmlns="http://hl7.org/fhir">
    <id value="apim-eps-futures" />
    <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition">
        <extension url="implementationGuide">
            <extension url="name">
                <valueString value="uk.nhsdigital.r4.test" />
            </extension>
        </extension>
        <extension url="implementationGuide">
            <extension url="name">
                <valueString value="uk.nhsdigital.medicines.r4.test" />
            </extension>
        </extension>
        <extension url="implementationGuide">
            <extension url="name">
                <valueString value="UKCore.Release1.test" />
            </extension>
            <extension url="version">
                <valueString value="1.2.2-prerelease" />
            </extension>
        </extension>
        <extension url="openApi">
            <extension url="documentation">
                <valueUri value="https://digital.nhs.uk/developer/api-catalogue/electronic-prescription-service-fhir" />
            </extension>
            <extension url="description">
                <valueString value="Electronic Prescription Service - FHIR API" />
            </extension>
        </extension>
    </extension>
    <url value="https://fhir.nhs.uk/CapabilityStatement/apim-eps-futures" />
    <version value="3.0.0" />
    <name value="APIMEPSFutures" />
    <status value="active" />
    <date value="2021-04-28T00:00:00+00:00" />
    <publisher value="digital.nhs.uk" />
    <description value="Conformance requirements for NHS Digital EPS Futures" />
    <kind value="requirements" />
    <implementationGuide value="https://simplifier.net/guide/nhsdigital-medicine"/>
    <implementationGuide value="https://simplifier.net/guide/nhsdigital"/>
    <fhirVersion value="4.0.1" />
    <format value="application/fhir+json" />
    <rest>
        <mode value="server" />
        <security>
            <service>
                <coding>
                    <system value="http://terminology.hl7.org/CodeSystem/restful-security-service" />
                    <code value="OAuth" />
                    <display value="OAuth2 Token" />
                </coding>
            </service>
        </security>
        <resource>
            <type value="Claim" />
            <profile value="https://fhir.nhs.uk/StructureDefinition/NHSDigital-Claim" />
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="response">
                        <extension url="resource">
                            <valueCode value="Claim" />
                        </extension>
                        <extension url="id">
                            <valueString value="258E153F-567B-4D60-B045-BA315A6B8DB0" />
                        </extension>
                    </extension>
                </extension>
                <code value="read" />
                <documentation value="New feature to view submitted claims."/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="request">
                        <extension url="resource">
                            <valueCode value="Claim" />
                        </extension>
                        <extension url="id">
                            <valueString value="258E153F-567B-4D60-B045-BA315A6B8DB0" />
                        </extension>
                    </extension>
                </extension>
                <code value="create" />
                <documentation value="Use this endpoint to submit a claim for reimbursement for a dispensed prescription."/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="request">
                        <extension url="resource">
                            <valueCode value="Claim" />
                        </extension>
                        <extension url="id">
                            <valueString value="7447c471-1ce0-4f5f-9dab-5ffd758c289e" />
                        </extension>
                    </extension>
                </extension>
                <code value="update" />
                <documentation value="Use this endpoint to submit a claim for reimbursement for a dispensed prescription."/>
            </interaction>
        </resource>
        <resource>
            <type value="MedicationRequest" />
            <profile value="https://fhir.nhs.uk/StructureDefinition/NHSDigital-MedicationRequest-Contained" />
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="response">
                        <extension url="resource">
                            <valueCode value="MedicationRequest" />
                        </extension>
                        <extension url="id">
                            <valueString value="A7B86F8D-1D7C-FC28-E050-D20AE3A215F4" />
                        </extension>
                    </extension>
                </extension>
                <code value="search-type" />
                <documentation value="This was proposeed as an extension to the EPS Tracker in NextGen but not implemented."/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="response">
                        <extension url="resource">
                            <valueCode value="MedicationRequest" />
                        </extension>
                        <extension url="id">
                            <valueString value="A7B86F8D-1D7C-FC28-E050-D20AE3A215F4" />
                        </extension>
                    </extension>
                </extension>
                <code value="read" />
                <documentation value="**Download presription (part)** and **Prescription Traacking**. Tracker*This was proposeed as an extension to the EPS Tracker in NextGen but not implemented."/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="request">
                        <extension url="resource">
                            <valueCode value="MedicationRequest" />
                        </extension>
                        <extension url="id">
                            <valueString value="A7B86F8D-1D7C-FC28-E050-D20AE3A215F4" />
                        </extension>
                    </extension>
                </extension>
                <code value="create" />
                <documentation value="**Create a new prescription**. Equivalent to `prescription-order` message in NextGen"/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="request">
                        <extension url="resource">
                            <valueCode value="MedicationRequest" />
                        </extension>
                        <extension url="id">
                            <valueString value="A7B86F8D-1D7C-FC28-E050-D20AE3A215F4" />
                        </extension>
                    </extension>
                </extension>
                <code value="update" />
                <documentation value="New feature. `prescription-order-update` was closer to PUT //Task described below and cancelled fulfilment"/>
            </interaction>
            <interaction>
                <code value="patch" />
                <documentation value="New feature. `prescription-order-update` was closer to PUT //Task described below and cancelled fulfilment"/>
            </interaction>
            <searchParam>
                <name value="patient:identifier" />
                <type value="token" />
                <documentation value="Returns prescriptions for a specific patientt identifier (NHS Number)" />
            </searchParam>
            <searchParam>
                <name value="patient" />
                <type value="reference" />
                <documentation value="Returns prescriptions for a specific patient" />
            </searchParam>
            <searchParam>
                <name value="medication" />
                <type value="reference" />
                <documentation value="Return prescriptions for this medication reference" />
            </searchParam>
            <searchParam>
                <name value="status" />
                <type value="token" />
                <documentation value="Status of the prescription" />
            </searchParam>
            <searchParam>
                <name value="authoredon" />
                <type value="date" />
                <documentation value="Return prescriptions written on this date" />
            </searchParam>
        </resource>
        <resource>
            <type value="MedicationDispense" />
            <profile value="https://fhir.nhs.uk/StructureDefinition/NHSDigital-MedicationDispense" />
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="response">
                        <extension url="resource">
                            <valueCode value="MedicationDispense" />
                        </extension>
                        <extension url="id">
                            <valueString value="06167339-9337-D030-0366-514A6A46DA17" />
                        </extension>
                    </extension>
                </extension>
                <code value="search-type" />
                <documentation value="This was proposeed as an extension to the EPS Tracker in NextGen but not implemented."/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="response">
                        <extension url="resource">
                            <valueCode value="MedicationDispense" />
                        </extension>
                        <extension url="id">
                            <valueString value="06167339-9337-D030-0366-514A6A46DA17" />
                        </extension>
                    </extension>
                </extension>
                <code value="read" />
                <documentation value="This was proposeed as an extension to the EPS Tracker in NextGen but not implemented."/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="request">
                        <extension url="resource">
                            <valueCode value="MedicationDispense" />
                        </extension>
                        <extension url="id">
                            <valueString value="06167339-9337-D030-0366-514A6A46DA17" />
                        </extension>
                    </extension>
                </extension>
                <code value="create" />
                <documentation value="**Mark a prescription as Dispensed**. Equivalent to `dispense-notification` in NextGen"/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="request">
                        <extension url="resource">
                            <valueCode value="MedicationDispense" />
                        </extension>
                        <extension url="id">
                            <valueString value="06167339-9337-D030-0366-514A6A46DA17" />
                        </extension>
                    </extension>
                </extension>
                <code value="update" />
                <documentation value="**Mark a prescription as Dispensed**. Equivalent to `dispense-notification-update` message in NextGen"/>
            </interaction>
            <interaction>
                <code value="patch" />
            </interaction>
            <interaction>
                <code value="delete" />
                <documentation value="**Withdraw a dispense notification**. Equivalent of the withdraw all dispense notifications in NextGen"/>
            </interaction>
            <searchParam>
                <name value="patient:identifier" />
                <type value="token" />
                <documentation value="The identity (NHS Number) of a patient to list dispenses for" />
            </searchParam>
            <searchParam>
                <name value="patient" />
                <type value="reference" />
                <documentation value="The identity of a patient to list dispenses for" />
            </searchParam>
        </resource>
        <resource>
            <type value="Task" />
            <profile value="https://fhir.nhs.uk/StructureDefinition/NHSDigital-DM-Task" />
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="request">
                        <extension url="resource">
                            <valueCode value="Task" />
                        </extension>
                        <extension url="id">
                            <valueString value="702cc4e9-81fc-470e-8ae1-43120ae5c16d" />
                        </extension>
                    </extension>
                </extension>
                <code value="create" />
                <documentation value="**Download prescriptions**. The $lock operation in futures design, this has some overlap with the `$release` operation in NextGen (the part of that operation which changed state)"/>
            </interaction>
            <interaction>
                <extension url="https://fhir.nhs.uk/StructureDefinition/Extension-NHSDigital-APIDefinition-Examples">
                    <extension url="request">
                        <extension url="resource">
                            <valueCode value="Task" />
                        </extension>
                        <extension url="id">
                            <valueString value="ee1b55f8-113c-4725-99a3-25fbad366dd6" />
                        </extension>
                    </extension>
                </extension>
                <code value="update" />
                <documentation value="**Return a downloaded prescription** and **Cancel a prescription**. The $unlock operation in futures design. Used for returns prescriptions to spine" />
            </interaction>
        </resource>
        <operation>
            <name value="prepare" />
            <definition value="https://fhir.nhs.uk/OperationDefinition/MessageHeader-prepare-message" />
        </operation>
    </rest>
</CapabilityStatement>