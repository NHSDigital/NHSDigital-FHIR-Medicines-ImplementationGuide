<OperationDefinition xmlns="http://hl7.org/fhir">
    <id value="Task-release-message"></id>
    <meta>
        <lastUpdated value="2019-11-01T09:29:23.356+11:00"></lastUpdated>
    </meta>
    <url value="https://fhir.nhs.uk/OperationDefinition/Task-release-message"></url>
    <version value="4.0.1"></version>
    <name value="releaseTask"></name>
    <status value="draft"></status>
    <kind value="operation"></kind>
    <date value="2020-11-13T09:29:23+11:00"></date>
    <publisher value="NHS Digital"></publisher>
    <contact>
        <telecom>
            <system value="email"></system>
            <value value="interoperabilityteam@nhs.net"></value>
        </telecom>
    </contact>
    <description value="Use this endpoint to download prescriptions from Spine before it is dispensed. You can download a single prescription using the prescription's ID, or download up to 25 prescriptions (per request) nominated to a dispenser using the dispenser's ODS code."></description>
    <code value="release"></code>
    <comment value="Only one of the parameters group-identifier and owner MUST be provided. This operation performs both a query on the message queue and updates the status of returned prescriptions.
    ### accept  

The only value to be used is `accepted`. This is for consistency with {{pagelink:NHSDigital-Task-duplicate-2}} and for future use.

```json
        {
            "name": "status",
            "valueCode": "accepted"
        },
```

<a name="agent"></a>
### agent

This is a <a href="https://simplifier.net/guide/nhsdigital/NHSDigital-PractitionerRole">NHSDigital-PractitionerRole</a> resource. Strict compliance to the profile is not enforced but selected fields are required depending on the interaction being invoked:

<br/>

<table class="regular" style="width:100%">
 <thead>
   <tr>
     <th data-no-sort width="25%">PractitionerRole</th>
     <th data-no-sort width="25%">Patient Release Request (attended)</th>
     <th data-no-sort width="25%">Nominated Pharmacy Release Request (attended)</th>
      <th data-no-sort width="25%">Nominated Pharmacy Release Request (unattended)</th>
   </tr>
 </thead>
 <tbody>
   <tr>
    <td>
        identifier
    </td>
    <td>
    </td>
     <td>
    </td>
    <td>
&checkmark;
    </td>
   </tr>
   <tr>
    <td>
        practitioner (professional code)
    </td>
    <td>
recommended    
    </td>
     <td>
recommended    
    </td>
    <td>
   </td>
   </tr>
    <tr>
    <td>
        practitioner (sds-user-id)
    </td>
    <td>
    
    </td>
     <td>
    </td>
    <td>
&checkmark;
    </td>
   </tr>
   <tr>
    <td>
        code (sds user role)
    </td>
    <td>
    
    </td>
     <td>
    
    </td>
    <td>
&checkmark;
    </td>
   </tr>
    <tr>
    <td>
        organization (ODS code)
    </td>
    <td>
    
    </td>
     <td>
     &checkmark; (if different to owner)
    </td>
    <td>
 &checkmark; (if different to owner)
    </td>
   </tr>
      <tr>
    <td>
       telecom
    </td>
    <td>
    &checkmark;
    </td>
     <td>
     &checkmark;
    </td>
    <td>
&checkmark;
    </td>
   </tr>
   </tbody>
</table>

<br />

For attended request this should match CIS2 details being used. For unattended requests, a practitioner is still required, this should be a nominated member of the pharmacy and the data reflects their CIS2 identity.

The value of the `telecom` field should be the contact number a prescriber will use to contact the pharmacy."></comment>
    <resource value="Task"></resource>
    <affectsState value="true" />
    <system value="false"></system>
    <type value="true"></type>
    <instance value="false"></instance>
    <parameter>
        <name value="group-identifier"></name>
        <use value="in"></use>
        <min value="0"></min>
        <max value="1"></max>
        <documentation value="The short-form-prescription-id (token) of the prescription. Used for releasing Patient prescriptions"></documentation>
        <type value="Identifier"></type>
    </parameter>
    <parameter>
        <name value="owner"></name>
        <use value="in"></use>
        <min value="1"></min>
        <max value="1"></max>
        <documentation value="The ODS code of the pharmacy. Used for releasing Nominated Pharmacy prescriptions"></documentation>
        <type value="Identifier"></type>
    </parameter>
    <parameter>
        <name value="status"></name>
        <use value="in"></use>
        <min value="1"></min>
        <max value="1"></max>
        <documentation value="Status from ValueSet http://hl7.org/fhir/valueset-task-status.html Use: accepted"></documentation>
        <type value="code"></type>
    </parameter>
    <parameter>
        <name value="agent"></name>
        <use value="in"></use>
        <min value="1"></min>
        <max value="1"></max>
        <documentation value="The professional submitting the release request"></documentation>
        <type value="PractitionerRole"></type>
    </parameter>
    <parameter>
        <name value="return"></name>
        <use value="out"></use>
        <min value="1"></min>
        <max value="1"></max>
        <documentation value="A FHIR Bundle (type=searchset) which contains prescription-order FHIR Messages which match the search parameters. An empty search will still return a FHIR Bundle but with no entries."></documentation>
        <type value="Bundle"></type>
    </parameter>
</OperationDefinition>